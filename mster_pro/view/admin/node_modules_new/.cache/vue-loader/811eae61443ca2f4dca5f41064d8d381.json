{"remainingRequest":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\phpstudy_pro\\WWW\\master\\view\\admin\\src\\views\\marketing\\preSale\\info.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\src\\views\\marketing\\preSale\\info.vue","mtime":1607484373000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { preSaleProDetailApi, presellProductStatusApi } from '@/api/product'\nconst defaultObj = {\n  image: '',\n  slider_image: [],\n  store_name: '',\n  store_info: '',\n  keyword: '',\n  brand_id: '', // 品牌id\n  cate_id: '', // 平台分类id\n  mer_cate_id: [], // 商户分类id\n  unit_name: '',\n  sort: 0,\n  is_show: 0,\n  is_benefit: 0,\n  is_new: 0,\n  is_good: 0,\n  temp_id: '',\n  attrValue: [{\n    image: '',\n    price: null,\n    down_price: null,\n    cost: null,\n    ot_price: null,\n    stock: null,\n    bar_code: '',\n    weight: null,\n    volume: null\n  }],\n  attr: [],\n  selectRule: '',\n  extension_type: 0,\n  content: '',\n  spec_type: 0\n}\nconst presellObj = [{\n    image: '',\n    price: null,\n    cost: null,\n    ot_price: null,\n    stock: null,\n    bar_code: '',\n    weight: null,\n    volume: null\n  }]\nconst objTitle = {\n  price: {\n    title: '售价'\n  },\n  cost: {\n    title: '成本价'\n  },\n  ot_price: {\n    title: '原价'\n  },\n  stock: {\n    title: '限量'\n  },\n  bar_code: {\n    title: '商品编号'\n  },\n  weight: {\n    title: '重量（KG）'\n  },\n  volume: {\n    title: '体积(m³)'\n  }\n}\nconst objTitle2 = {\n  price: {\n    title: '售价'\n  },\n  down_price: {\n    title: '定金'\n  },\n  cost: {\n    title: '成本价'\n  },\n  ot_price: {\n    title: '原价'\n  },\n  stock: {\n    title: '限量'\n  },\n  bar_code: {\n    title: '商品编号'\n  },\n  weight: {\n    title: '重量（KG）'\n  },\n  volume: {\n    title: '体积(m³)'\n  }\n}\nconst proOptions = [{ name: '是否热卖', value: 'is_hot' }, { name: '优品推荐', value: 'is_good' }, { name: '促销单品', value: 'is_benefit' }, { name: '是否精品', value: 'is_best' }, { name: '是否新品', value: 'is_new' }]\nexport default {\n  name: 'Info',\n  props: {\n    isShow: {\n      type: Boolean,\n      default: true\n    },\n    ids: {\n      type: Array,\n      default: () => []\n    }\n  },\n  data() {\n    return {\n      rules: {\n        status: [\n          { required: true, message: '请选择审核状态', trigger: 'change' }\n        ],\n        refusal: [\n          { required: true, message: '请填写拒绝原因', trigger: 'blur' }\n        ]\n      },\n      proId: 0,\n      ruleForm: {\n        refusal: '',\n        status: 1,\n        id: ''\n      },\n      formThead: Object.assign({}, objTitle),\n      formThead2: Object.assign({}, objTitle2),\n      manyTabDate: {},\n      manyTabTit: {},\n      loading: false,\n      dialogVisible: false,\n      activeNames: 'first',\n      projectData: {},\n      recommend: proOptions,\n      checkboxGroup: [],\n      OneattrValue: [Object.assign({}, defaultObj.attrValue[0])], // 单规格\n      ManyAttrValue: [Object.assign({}, defaultObj.attrValue[0])], // 多规格\n      presellObj: [{\n        image: '',\n        price: null,\n        cost: null,\n        ot_price: null,\n        stock: null,\n        bar_code: '',\n        weight: null,\n        volume: null\n     }]\n    }\n  },\n  computed: {\n      attrValue() {\n        if(this.projectData.presell_type === 1){\n            const obj = Object.assign({}, this.presellObj[0])\n            delete obj.image\n            return obj\n        }else{\n           const obj = Object.assign({}, defaultObj.attrValue[0])\n           delete obj.image\n           return obj\n        }\n    }\n  },\n  methods: {\n    onSubmit() {\n      this.ruleForm.id = this.projectData.product_presell_id\n      presellProductStatusApi(this.ruleForm).then(res => {\n        this.$message.success(res.message)\n        this.dialogVisible = false\n        this.activeNames = 'first'\n        this.$emit('subSuccess')\n      }).catch(res => {\n        this.listLoading = false\n        this.$message.error(res.message)\n      })\n    },\n    handleClose() {\n      this.dialogVisible = false\n      this.activeNames = 'first'\n    },\n    getInfo(id) {\n      this.proId = id\n      this.loading = true\n      preSaleProDetailApi(id).then(res => {\n        this.projectData = res.data\n        const tmp = {}\n        const tmpTab = {}\n        this.projectData.attr.forEach((o, i) => {\n          tmp['value' + i] = { title: o.value }\n          tmpTab['value' + i] = ''\n        })\n        this.manyTabDate = tmpTab\n        this.manyTabTit = tmp\n        if(this.projectData.presell_type === 1){  //全款\n            this.formThead = Object.assign({}, this.formThead, tmp)\n            if (this.projectData.spec_type === 0) { //单规格\n                this.OneattrValue = res.data.attrValue\n               this.OneattrValue[0]['ot_price'] = this.OneattrValue[0]['price']\n                this.OneattrValue[0]['price'] = this.OneattrValue[0].presellSku['presell_price']\n                this.OneattrValue[0]['stock'] = this.OneattrValue[0].presellSku['stock']\n\n            } else { //多规格\n                this.ManyAttrValue = []\n                res.data.attrValue.forEach((val, i) => {\n                    if(val.presellSku){\n                    this.ManyAttrValue.push(val)\n                    this.ManyAttrValue[i]['ot_price'] = this.ManyAttrValue[i]['price']\n                    this.ManyAttrValue[i]['price'] = this.ManyAttrValue[i].presellSku['presell_price']\n                    this.ManyAttrValue[i]['stock'] = this.ManyAttrValue[i].presellSku['stock']\n\n                    }\n                })\n            }\n        }else{ //定金\n            this.formThead = Object.assign({}, this.formThead2, tmp)\n            if (this.projectData.spec_type === 0) { //单规格\n                this.OneattrValue = res.data.attrValue\n                this.OneattrValue[0]['ot_price'] = this.OneattrValue[0]['price']\n                this.OneattrValue[0]['down_price'] = this.OneattrValue[0].presellSku['down_price']\n                this.OneattrValue[0]['price'] = this.OneattrValue[0].presellSku['presell_price']\n                this.OneattrValue[0]['stock'] = this.OneattrValue[0].presellSku['stock']\n\n\n            } else { //多规格\n                this.ManyAttrValue = []\n                res.data.attrValue.forEach((val, i) => {\n                    if(val.presellSku){\n                        this.ManyAttrValue.push(val)\n                        this.ManyAttrValue[i]['ot_price'] = this.ManyAttrValue[i]['price']\n                        this.ManyAttrValue[i]['price'] = this.ManyAttrValue[i].presellSku['presell_price']\n                        this.ManyAttrValue[i]['stock'] = this.ManyAttrValue[i].presellSku['stock']\n\n                        this.ManyAttrValue[i]['down_price'] = this.ManyAttrValue[i].presellSku['down_price']\n                    }\n                })\n            }\n        }\n        if (this.projectData.is_hot === 1) this.checkboxGroup.push('is_hot')\n        if (this.projectData.is_good === 1) this.checkboxGroup.push('is_good')\n        if (this.projectData.is_benefit === 1) this.checkboxGroup.push('is_benefit')\n        if (this.projectData.is_best === 1) this.checkboxGroup.push('is_best')\n        if (this.projectData.is_new === 1) this.checkboxGroup.push('is_new')\n        this.loading = false\n      }).catch(res => {\n        this.$message.error(res.message)\n        this.loading = false\n      })\n    }\n  }\n}\n",null]}