{"remainingRequest":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\babel-loader\\lib\\index.js!D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\phpstudy_pro\\WWW\\master\\view\\admin\\src\\views\\app\\wechat\\newsCategory\\save.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\src\\views\\app\\wechat\\newsCategory\\save.vue","mtime":1609299900000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:/phpstudy_pro/WWW/master/view/admin/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"D:/phpstudy_pro/WWW/master/view/admin/node_modules/@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _ueditorFrom = _interopRequireDefault(require(\"@/components/ueditorFrom\"));\n\nvar _app = require(\"@/api/app\");\n\nvar _settings = require(\"@/settings\");\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  name: 'Save',\n  components: {\n    ueditorFrom: _ueditorFrom.default\n  },\n  data: function data() {\n    var _this2 = this;\n\n    var validateUpload = function validateUpload(rule, value, callback) {\n      if (_this2.saveForm.image_input) {\n        callback();\n      } else {\n        callback(new Error('请上传图文封面'));\n      }\n    };\n\n    return {\n      roterPre: _settings.roterPre,\n      ruleValidate: {\n        title: [{\n          required: true,\n          message: '请输入标题',\n          trigger: 'blur'\n        }],\n        author: [{\n          required: true,\n          message: '请输入作者',\n          trigger: 'blur'\n        }],\n        image_input: [{\n          required: true,\n          validator: validateUpload,\n          trigger: 'change'\n        }],\n        content: [{\n          required: true,\n          message: '请输入正文',\n          trigger: 'change'\n        }],\n        synopsis: [{\n          required: true,\n          message: '请输入文章摘要',\n          trigger: 'blur'\n        }]\n      },\n      isChoice: '单选',\n      dragging: null,\n      isDel: false,\n      msg: '',\n      count: [],\n      baseImg: require(\"../../../../assets/images/bjt.png\"),\n      saveForm: {\n        title: '',\n        author: '',\n        synopsis: '',\n        image_input: '',\n        content: ''\n      },\n      current: 0,\n      data: [{\n        title: '',\n        author: '',\n        synopsis: '',\n        image_input: '',\n        content: ''\n      }],\n      uploadList: [],\n      modalPic: false,\n      gridPic: {\n        xl: 6,\n        lg: 8,\n        md: 12,\n        sm: 12,\n        xs: 12\n      },\n      gridBtn: {\n        xl: 4,\n        lg: 8,\n        md: 8,\n        sm: 8,\n        xs: 8\n      }\n    };\n  },\n  watch: {\n    $route: function $route(to, from) {\n      if (this.$route.params.id) {\n        this.info();\n      }\n    }\n  },\n  mounted: function mounted() {\n    if (this.$route.params.id) {\n      this.info();\n    }\n  },\n  methods: {\n    modalPicTap: function modalPicTap() {\n      var _this = this;\n\n      _this.$modalUpload(function (img) {\n        _this.saveForm.image_input = img[0];\n      });\n    },\n    // 添加图文按钮\n    handleAdd: function handleAdd() {\n      if (!this.check()) return false;\n      var obj = {\n        title: '',\n        author: '',\n        synopsis: '',\n        image_input: '',\n        content: ''\n      };\n      this.data.push(obj);\n    },\n    // 点击模块\n    onSubSave: function onSubSave(i) {\n      var _this3 = this;\n\n      this.current = i;\n      this.data.map(function (item, index) {\n        /* eslint-disable */\n        if (index === _this3.current) {\n          _this3.saveForm = _this3.data[_this3.current];\n        }\n      });\n    },\n    // 删除\n    del: function del(i) {\n      if (i === 0) {\n        this.$message.warning('不能再删除了');\n      } else {\n        this.data.splice(i, 1);\n        this.saveForm = {};\n      }\n    },\n    // 详情\n    info: function info() {\n      var _this4 = this;\n\n      (0, _app.wechatNewsInfotApi)(this.$route.params.id).then( /*#__PURE__*/function () {\n        var _ref = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee(res) {\n          var info;\n          return regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  info = res.data;\n                  _this4.data = info.article;\n\n                  _this4.data.map(function (item) {\n                    item.content = item.content.content;\n                  });\n\n                  _this4.saveForm = _this4.data[_this4.current];\n\n                case 4:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()).catch(function (res) {\n        _this4.$message.error(res.message);\n      });\n    },\n    // 提交数据\n    subFrom: function subFrom(name) {\n      var _this5 = this;\n\n      this.$refs[name].validate(function (valid) {\n        if (valid) {\n          var data = [_this5.saveForm];\n          data = _this5.current === '' ? data : _this5.data;\n          _this5.$route.params.id ? (0, _app.wechatNewsUpdateApi)(_this5.$route.params.id, _this5.data).then( /*#__PURE__*/function () {\n            var _ref2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(res) {\n              return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                while (1) {\n                  switch (_context2.prev = _context2.next) {\n                    case 0:\n                      _this5.$message.success(res.message);\n\n                      setTimeout(function () {\n                        _this5.$router.push({\n                          path: \"\".concat(_settings.roterPre, \"/app/wechat/newsCategory\")\n                        });\n                      }, 500);\n\n                    case 2:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }\n              }, _callee2);\n            }));\n\n            return function (_x2) {\n              return _ref2.apply(this, arguments);\n            };\n          }()).catch(function (res) {\n            _this5.$message.error(res.message);\n          }) : (0, _app.wechatNewsAddApi)([_this5.saveForm]).then( /*#__PURE__*/function () {\n            var _ref3 = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(res) {\n              return regeneratorRuntime.wrap(function _callee3$(_context3) {\n                while (1) {\n                  switch (_context3.prev = _context3.next) {\n                    case 0:\n                      _this5.$message.success(res.message);\n\n                      setTimeout(function () {\n                        _this5.$router.push({\n                          path: \"\".concat(_settings.roterPre, \"/app/wechat/newsCategory\")\n                        });\n                      }, 500);\n\n                    case 2:\n                    case \"end\":\n                      return _context3.stop();\n                  }\n                }\n              }, _callee3);\n            }));\n\n            return function (_x3) {\n              return _ref3.apply(this, arguments);\n            };\n          }()).catch(function (res) {\n            _this5.$message.error(res.message);\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    check: function check() {\n      for (var index in this.data) {\n        if (!this.data[index].title) {\n          this.$message.warning('请输入文章的标题');\n          return false;\n        } else if (!this.data[index].author) {\n          this.$message.warning('请输入文章的作者');\n          return false;\n        } else if (!this.data[index].synopsis) {\n          this.$message.warning('请输入文章的摘要');\n          return false;\n        } else if (!this.data[index].image_input) {\n          this.$message.warning('请输入文章的图文封面');\n          return false;\n        } else if (!this.data[index].content) {\n          this.$message.warning('请输入文章的内容');\n          return false;\n        } else {\n          return true;\n        }\n      }\n    }\n  }\n};\nexports.default = _default;",null]}