{"remainingRequest":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\babel-loader\\lib\\index.js!D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\phpstudy_pro\\WWW\\master\\view\\admin\\src\\views\\maintain\\dataBackup\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\src\\views\\maintain\\dataBackup\\index.vue","mtime":1612520340000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\phpstudy_pro\\WWW\\master\\view\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:/phpstudy_pro/WWW/master/view/admin/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"D:/phpstudy_pro/WWW/master/view/admin/node_modules/@babel/runtime/helpers/asyncToGenerator\"));\n\nrequire(\"core-js/modules/es6.function.name\");\n\nvar _maintain = require(\"@/api/maintain\");\n\nvar _settingMer = _interopRequireDefault(require(\"@/libs/settingMer\"));\n\nvar _auth = require(\"@/utils/auth\");\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  name: 'DataBackup',\n  data: function data() {\n    return {\n      tableData: {\n        data: []\n      },\n      databaseData: {\n        data: []\n      },\n      listLoading: false,\n      listLoading1: false,\n      selectionList: [],\n      dataList: {},\n      dialogVisible: false,\n      tabList: [],\n      rows: {}\n    };\n  },\n  mounted: function mounted() {\n    this.getList();\n    this.getListDatabase();\n  },\n  methods: {\n    exportData: function exportData() {\n      var _this = this;\n\n      var formValidate = this.formValidate;\n      var data = {\n        is_show: formValidate.is_show,\n        store_name: formValidate.store_name\n      };\n      storeCombinationApi(data).then(function (res) {\n        location.href = res.data[0];\n      }).catch(function (res) {\n        _this.$message.error(res.message);\n      });\n    },\n    download: function download(feilname) {\n      window.open(_settingMer.default.https + \"/safety/database/download/\".concat(feilname, \"?token=\") + (0, _auth.getToken)()); // downloadApi(feilname).then(async res => {\n      //   console.log(res)\n      //   // let blob = new Blob([res], { type: 'application/vnd.ms-excel' }); // res就是接口返回的文件流了\n      //   const blob = new Blob([res], { type: 'application/zip' })\n      //   const objectUrl = URL.createObjectURL(blob)\n      //   console.log(objectUrl)\n      //   window.location.href = objectUrl\n      // }).catch(res => {\n      //   console.log(res)\n      //   this.$message.error(res.message)\n      // })\n    },\n    handleClose: function handleClose() {\n      this.dialogVisible = false;\n    },\n    handleSelectionChange: function handleSelectionChange(val) {\n      this.selectionList = val;\n      var tables = [];\n      this.selectionList.map(function (item) {\n        tables.push(item.name);\n      });\n      this.dataList = {\n        name: tables\n      };\n    },\n    // 详情\n    Info: function Info(row) {\n      var _this2 = this;\n\n      this.rows = row;\n      this.dialogVisible = true;\n      this.listLoading = true;\n      (0, _maintain.detailApi)(row.name).then( /*#__PURE__*/function () {\n        var _ref = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee(res) {\n          return regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _this2.tabList = res.data;\n                  _this2.listLoading = false;\n\n                case 2:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()).catch(function (res) {\n        _this2.listLoading = false;\n\n        _this2.$message.error(res.message);\n      });\n    },\n    // 备份表\n    getBackup: function getBackup() {\n      var _this3 = this;\n\n      if (this.selectionList.length === 0) {\n        return this.$message.warning('请选择表');\n      }\n\n      this.$modalSure('是否备份数据库表').then(function () {\n        (0, _maintain.backupsApi)(_this3.dataList).then( /*#__PURE__*/function () {\n          var _ref2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(res) {\n            return regeneratorRuntime.wrap(function _callee2$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    _this3.$message.success(res.message);\n\n                  case 1:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, _callee2);\n          }));\n\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }()).catch(function (res) {\n          _this3.loading = false;\n\n          _this3.$message.error(res.message);\n        });\n      });\n    },\n    // 优化表\n    getOptimize: function getOptimize() {\n      var _this4 = this;\n\n      if (this.selectionList.length === 0) {\n        return this.$message.warning('请选择表');\n      }\n\n      this.$modalSure('是否优化数据库表').then(function () {\n        (0, _maintain.optimizeApi)(_this4.dataList).then( /*#__PURE__*/function () {\n          var _ref3 = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(res) {\n            return regeneratorRuntime.wrap(function _callee3$(_context3) {\n              while (1) {\n                switch (_context3.prev = _context3.next) {\n                  case 0:\n                    _this4.$message.success(res.message);\n\n                  case 1:\n                  case \"end\":\n                    return _context3.stop();\n                }\n              }\n            }, _callee3);\n          }));\n\n          return function (_x3) {\n            return _ref3.apply(this, arguments);\n          };\n        }()).catch(function (res) {\n          _this4.$message.error(res.message);\n        });\n      });\n    },\n    // 修复表\n    getRepair: function getRepair() {\n      var _this5 = this;\n\n      if (this.selectionList.length === 0) {\n        return this.$message.warning('请选择表');\n      }\n\n      this.$modalSure('是否修复数据库表').then(function () {\n        (0, _maintain.repairApi)(_this5.dataList).then( /*#__PURE__*/function () {\n          var _ref4 = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(res) {\n            return regeneratorRuntime.wrap(function _callee4$(_context4) {\n              while (1) {\n                switch (_context4.prev = _context4.next) {\n                  case 0:\n                    _this5.$message.success(res.message);\n\n                  case 1:\n                  case \"end\":\n                    return _context4.stop();\n                }\n              }\n            }, _callee4);\n          }));\n\n          return function (_x4) {\n            return _ref4.apply(this, arguments);\n          };\n        }()).catch(function (res) {\n          _this5.$message.error(res.message);\n        });\n      });\n    },\n    // 列表\n    getList: function getList() {\n      var _this6 = this;\n\n      this.listLoading1 = true;\n      (0, _maintain.fileListApi)().then(function (res) {\n        _this6.tableData.data = res.data;\n        _this6.listLoading1 = false;\n      }).catch(function (res) {\n        _this6.listLoading1 = false;\n\n        _this6.$message.error(res.message);\n      });\n    },\n    // 数据库表列表\n    getListDatabase: function getListDatabase() {\n      var _this7 = this;\n\n      this.listLoading = true;\n      (0, _maintain.databaseListApi)().then(function (res) {\n        _this7.databaseData.data = res.data;\n        _this7.listLoading = false;\n      }).catch(function (res) {\n        _this7.listLoading = false;\n\n        _this7.$message.error(res.message);\n      });\n    },\n    // 删除\n    handleDelete: function handleDelete(time, idx) {\n      var _this8 = this;\n\n      this.$modalSure().then(function () {\n        (0, _maintain.fileListDeleteApi)({\n          feilname: time\n        }).then(function (_ref5) {\n          var message = _ref5.message;\n\n          _this8.$message.success(message);\n\n          _this8.getList();\n        }).catch(function (_ref6) {\n          var message = _ref6.message;\n\n          _this8.$message.error(message);\n        });\n      });\n    }\n  }\n};\nexports.default = _default;",null]}